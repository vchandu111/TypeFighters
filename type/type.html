<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
      integrity="sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk"
      crossorigin="anonymous"
    />
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
      integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"
      integrity="sha384-OgVRvuATP1z7JjHLkuOU7Xw704+h835Lr+6QL9UvYjZE3Ipu6Tp75j7Bh/kR0JKI"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://kit.fontawesome.com/683b4b40e3.js"
      crossorigin="anonymous"
    ></script>
    <link rel="stylesheet" href="styles.css" />

    <title>Document</title>
  </head>

  <body>
    <div class="container">
      <div class="row">
        <div class="col-5 text-center box">
          <p class="text-monospace">Choose Difficulty Level</p>
          <div id="settings" class="settings">
            <form id="settings-form">
              <div>
                <select id="difficulty">
                  <option value="easy">Easy</option>
                  <option value="medium">Medium</option>
                  <option value="hard">Hard</option>
                </select>
              </div>
            </form>
          </div>
          <div style="height: 60px;"></div>
          <div id="end" class="end"></div>
        </div>
        <div class="col-6 text-center box">
          <h2 class="head">
            <!-- <span> <i class="fas fa-keyboard keyboard"></i> </span> -->
            Typing Game
            <!-- <span><i class="fas fa-trophy winner"></i></span> -->
          </h2>
          <p class="time float-right scorecard text-monospace">
            <span><i class="far fa-clock fa-1x"></i></span> Time :
            <Left:span id="time">10 sec</Left:span>
          </p>
          <p class="score float-left text-monospace">
            <span><i class="fas fa-poll"></i></span> Score :
            <span id="score">0</span>
          </p>
          <div style="height: 50px;"></div>
          <h1 id="word"></h1>
          <div class="inputWithIcon">
            <input
              type="text"
              id="text"
              autocomplete="off"
              placeholder="Type the Word here......"
            /><span>
              <i class="fas fa-keyboard keyboard fa-2x fa-color"></i>
            </span>
          </div>
        </div>
      </div>
    </div>

    <script>
      const word = document.getElementById("word");
      const text = document.getElementById("text");
      const score = document.getElementById("score");
      const time = document.getElementById("time");
      const end = document.getElementById("end");
      const difficultySelect = document.getElementById("difficulty");
      const settingsForm = document.getElementById("settings-form");
      const settings = document.getElementById("settings");

      const words = [
        "sigh",
        "tense",
        "airplane",
        "ball",
        "pies",
        "juice",
        "warlike",
        "bad",
        "north",
        "dependent",
        "steer",
        "silver",
        "highfalutin",
        "superficial",
        "quince",
        "eight",
        "feeble",
        "admit",
        "drag",
        "loving",
      ];

      let randomWord;
      let initialScore = 0;
      let initialTime = 7;
      let difficulty =
        localStorage.getItem("difficulty") !== null
          ? localStorage.getItem("difficulty")
          : "medium";

      difficultySelect.value =
        localStorage.getItem("difficulty") !== null
          ? localStorage.getItem("difficulty")
          : "medium";

      //generate random word
      function getRandomWord() {
        return words[Math.floor(Math.random() * words.length)];
      }
      //   console.log(getRandomWord());

      //Add word to DOM
      function addWordToDom() {
        randomWord = getRandomWord();
        word.innerHTML = randomWord;
      }
      addWordToDom();

      //event listener
      text.addEventListener("input", (e) => {
        const enteredInput = e.target.value;
        // console.log(enteredInput);

        if (enteredInput === randomWord) {
          addWordToDom();

          //clear
          e.target.value = "";

          //*****************do this at the last ,,jump to initialscore++

          if (difficulty === "hard") {
            initialTime += 2;
          } else if (difficulty === "medium") {
            initialTime += 5;
          } else {
            initialTime += 7;
          }

          updateTime();

          //score updating
          initialScore++;
          score.innerHTML = initialScore;
        }
      });

      //cursor to come automatically to input tag
      text.focus();

      //start counting down
      const timeLeft = setInterval(updateTime, 1000);

      function updateTime() {
        // console.log(1);
        initialTime--;
        time.innerHTML = initialTime + " " + "sec";

        if (initialTime === 0) {
          clearInterval(timeLeft);
          //game over
          gameOver();
        }
      }

      function gameOver() {
        end.innerHTML = `<h1>Time's Up</h1>
            <p>Your final score is ${initialScore}</p>
            <button onClick="location.reload()">Play Again</button>`;
      }

      //difficulty

      settingsForm.addEventListener("change", (e) => {
        difficulty = e.target.value;
        localStorage.setItem("difficulty", difficulty);
      });
    </script>
  </body>
</html>
